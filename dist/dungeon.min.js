!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.Dungeon=o():t.Dungeon=o()}("undefined"!=typeof self?self:this,function(){return function(t){var o={};function e(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var r in t)e.d(n,r,function(o){return t[o]}.bind(null,r));return n},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=17)}([function(t,o){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,o){(function(o){t.exports=o}).call(this,{})},function(t,o){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.default={EMPTY:0,WALL:1,FLOOR:2,DOOR:3}},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,o){var e=[],n=!0,r=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!o||e.length!==o);n=!0);}catch(t){r=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}return e}(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();o.debugRoomGrid=function(t){var o=t.roomGrid.map(function(t){return t.map(function(t){return(""+t.length).padStart(2)})});console.log(o.map(function(t){return t.join(" ")}).join("\n"))},o.debugHtmlMap=function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=o=Object.assign({},{empty:" ",emptyAttributes:{class:"dungeon__empty"},wall:"#",wallAttributes:{class:"dungeon__wall"},floor:"_",floorAttributes:{class:"dungeon__wall"},door:".",doorAttributes:{class:"dungeon__door"},containerAttributes:{class:"dungeon"}},o),n=t.getMappedTiles({empty:"<td "+i(e.emptyAttributes)+">"+e.empty+"</td>",floor:"<td "+i(e.floorAttributes)+">"+e.floor+"</td>",door:"<td "+i(e.doorAttributes)+">"+e.door+"</td>",wall:"<td "+i(e.wallAttributes)+">"+e.wall+"</td>"}).map(function(t){return"<tr>"+t.join("")+"</tr>"}).join(""),r="<pre "+i(e.containerAttributes)+"><table><tbody>"+n+"</tbody></table></pre>";return document.createRange().createContextualFragment(r)},o.debugMap=function(t){var o,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},{empty:" ",emptyColor:"rgb(0, 0, 0)",wall:"#",wallColor:"rgb(255, 0, 0)",floor:"_",floorColor:"rgb(210, 210, 210)",door:".",doorColor:"rgb(0, 0, 255)",fontSize:"15px"},e);var n="",i=[];n+="Dungeon: the console window should be big enough to see all of the guide on the next line:\n",n+="%c|"+"=".repeat(2*t.width-2)+"|\n\n",i.push("font-size: "+e.fontSize);for(var a=0;a<t.height;a+=1){for(var u=0;u<t.width;u+=1){var h=t.tiles[a][u];h===r.default.EMPTY?(n+="%c"+e.empty,i.push("color: "+e.emptyColor+"; font-size: "+e.fontSize)):h===r.default.WALL?(n+="%c"+e.wall,i.push("color: "+e.wallColor+"; font-size: "+e.fontSize)):h===r.default.FLOOR?(n+="%c"+e.floor,i.push("color: "+e.floorColor+"; font-size: "+e.fontSize)):h===r.default.DOOR&&(n+="%c"+e.door,i.push("color: "+e.doorColor+"; font-size: "+e.fontSize)),n+=" "}n+="\n"}(o=console).log.apply(o,[n].concat(i))};var r=function(t){return t&&t.__esModule?t:{default:t}}(e(3));var i=function(t){return Object.entries(t).map(function(t){var o=n(t,2);return o[0]+'="'+o[1]+'"'}).join(" ")}},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t,o){for(var e=0;e<o.length;e++){var n=o[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(o,e,n){return e&&t(o.prototype,e),n&&t(o,n),o}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(e(3));var i=function(){function t(o,e){!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=(new Date).getTime()*Math.floor(1e3*Math.random()/Math.random()*10),this.width=o,this.height=e,this.setPosition(0,0),this.doors=[],this.tiles=[];for(var n=0;n<this.height;n++){for(var i=[],a=0;a<this.width;a++)0==n||n==this.height-1||0==a||a==this.width-1?i.push(r.default.WALL):i.push(r.default.FLOOR);this.tiles.push(i)}}return n(t,[{key:"setPosition",value:function(t,o){this.x=t,this.y=o,this.left=t,this.right=t+(this.width-1),this.top=o,this.bottom=o+(this.height-1),this.centerX=t+Math.floor(this.width/2),this.centerY=o+Math.floor(this.height/2)}},{key:"getDoorLocations",value:function(){for(var t=[],o=0;o<this.height;o++)for(var e=0;e<this.width;e++)this.tiles[o][e]==r.default.DOOR&&t.push({x:e,y:o});return t}},{key:"overlaps",value:function(t){return!(this.right<t.left)&&(!(this.left>t.right)&&(!(this.bottom<t.top)&&!(this.top>t.bottom)))}},{key:"isConnectedTo",value:function(t){for(var o=this.doors,e=0;e<o.length;e++){return this.doors.map(function(t){return t.linksTo}).indexOf(t.id)>=0}return!1}}]),t}();o.default=i},function(t,o){},function(t,o,e){var n;!function(r,i){var a,u=this,h=256,s=6,f="random",l=i.pow(h,s),c=i.pow(2,52),d=2*c,m=h-1;function g(t,o,e){var n=[],g=y(function t(o,e){var n,r=[],i=typeof o;if(e&&"object"==i)for(n in o)try{r.push(t(o[n],e-1))}catch(t){}return r.length?r:"string"==i?o:o+"\0"}((o=1==o?{entropy:!0}:o||{}).entropy?[t,x(r)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(h):(t=new Uint8Array(h),(u.crypto||u.msCrypto).getRandomValues(t)),x(t)}catch(t){var o=u.navigator,e=o&&o.plugins;return[+new Date,u,e,u.screen,x(r)]}}():t,3),n),p=new function(t){var o,e=t.length,n=this,r=0,i=n.i=n.j=0,a=n.S=[];e||(t=[e++]);for(;r<h;)a[r]=r++;for(r=0;r<h;r++)a[r]=a[i=m&i+t[r%e]+(o=a[r])],a[i]=o;(n.g=function(t){for(var o,e=0,r=n.i,i=n.j,a=n.S;t--;)o=a[r=m&r+1],e=e*h+a[m&(a[r]=a[i=m&i+o])+(a[i]=o)];return n.i=r,n.j=i,e})(h)}(n),w=function(){for(var t=p.g(s),o=l,e=0;t<c;)t=(t+e)*h,o*=h,e=p.g(1);for(;t>=d;)t/=2,o/=2,e>>>=1;return(t+e)/o};return w.int32=function(){return 0|p.g(4)},w.quick=function(){return p.g(4)/4294967296},w.double=w,y(x(p.S),r),(o.pass||e||function(t,o,e,n){return n&&(n.S&&v(n,p),t.state=function(){return v(p,{})}),e?(i[f]=t,o):t})(w,g,"global"in o?o.global:this==i,o.state)}function v(t,o){return o.i=t.i,o.j=t.j,o.S=t.S.slice(),o}function y(t,o){for(var e,n=t+"",r=0;r<n.length;)o[m&r]=m&(e^=19*o[m&r])+n.charCodeAt(r++);return x(o)}function x(t){return String.fromCharCode.apply(0,t)}if(i["seed"+f]=g,y(i.random(),r),"object"==typeof t&&t.exports){t.exports=g;try{a=e(6)}catch(t){}}else void 0===(n=function(){return g}.call(o,e,o,t))||(t.exports=n)}([],Math)},function(t,o,e){(function(t){var n;!function(t,r,i){function a(t,o){return o.a=t.a,o.b=t.b,o.c=t.c,o.d=t.d,o}function u(t,o){var e=new function(t){var o=this,e="";o.next=function(){var t=o.b,e=o.c,n=o.d,r=o.a;return t=t<<25^t>>>7^e,e=e-n|0,n=n<<24^n>>>8^r,r=r-t|0,o.b=t=t<<20^t>>>12^e,o.c=e=e-n|0,o.d=n<<16^e>>>16^r,o.a=r-t|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,t===Math.floor(t)?(o.a=t/4294967296|0,o.b=0|t):e+=t;for(var n=0;n<e.length+20;n++)o.b^=0|e.charCodeAt(n),o.next()}(t),n=o&&o.state,r=function(){return(e.next()>>>0)/4294967296};return r.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=e.next,r.quick=r,n&&("object"==typeof n&&a(n,e),r.state=function(){return a(e,{})}),r}r&&r.exports?r.exports=u:e(0)&&e(1)?void 0===(n=function(){return u}.call(o,e,o,r))||(r.exports=n):this.tychei=u}(0,"object"==typeof t&&t,e(0))}).call(this,e(2)(t))},function(t,o,e){(function(t){var n;!function(t,r,i){function a(t,o){return o.i=t.i,o.w=t.w,o.X=t.X.slice(),o}function u(t,o){null==t&&(t=+new Date);var e=new function(t){var o=this;o.next=function(){var t,e,n=o.w,r=o.X,i=o.i;return o.w=n=n+1640531527|0,e=r[i+34&127],t=r[i=i+1&127],e^=e<<13,t^=t<<17,e^=e>>>15,t^=t>>>12,e=r[i]=e^t,o.i=i,e+(n^n>>>16)|0},function(t,o){var e,n,r,i,a,u=[],h=128;for(o===(0|o)?(n=o,o=null):(o+="\0",n=0,h=Math.max(h,o.length)),r=0,i=-32;i<h;++i)o&&(n^=o.charCodeAt((i+32)%o.length)),0===i&&(a=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,i>=0&&(a=a+1640531527|0,r=0==(e=u[127&i]^=n+a)?r+1:0);for(r>=128&&(u[127&(o&&o.length||0)]=-1),r=127,i=512;i>0;--i)n=u[r+34&127],e=u[r=r+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,u[r]=n^e;t.w=a,t.X=u,t.i=r}(o,t)}(t),n=o&&o.state,r=function(){return(e.next()>>>0)/4294967296};return r.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=e.next,r.quick=r,n&&(n.X&&a(n,e),r.state=function(){return a(e,{})}),r}r&&r.exports?r.exports=u:e(0)&&e(1)?void 0===(n=function(){return u}.call(o,e,o,r))||(r.exports=n):this.xor4096=u}(0,"object"==typeof t&&t,e(0))}).call(this,e(2)(t))},function(t,o,e){(function(t){var n;!function(t,r,i){function a(t,o){return o.x=t.x.slice(),o.i=t.i,o}function u(t,o){null==t&&(t=+new Date);var e=new function(t){var o=this;o.next=function(){var t,e,n=o.x,r=o.i;return t=n[r],e=(t^=t>>>7)^t<<24,e^=(t=n[r+1&7])^t>>>10,e^=(t=n[r+3&7])^t>>>3,e^=(t=n[r+4&7])^t<<7,t=n[r+7&7],e^=(t^=t<<13)^t<<9,n[r]=e,o.i=r+1&7,e},function(t,o){var e,n=[];if(o===(0|o))n[0]=o;else for(o=""+o,e=0;e<o.length;++e)n[7&e]=n[7&e]<<15^o.charCodeAt(e)+n[e+1&7]<<13;for(;n.length<8;)n.push(0);for(e=0;e<8&&0===n[e];++e);for(8==e?n[7]=-1:n[e],t.x=n,t.i=0,e=256;e>0;--e)t.next()}(o,t)}(t),n=o&&o.state,r=function(){return(e.next()>>>0)/4294967296};return r.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=e.next,r.quick=r,n&&(n.x&&a(n,e),r.state=function(){return a(e,{})}),r}r&&r.exports?r.exports=u:e(0)&&e(1)?void 0===(n=function(){return u}.call(o,e,o,r))||(r.exports=n):this.xorshift7=u}(0,"object"==typeof t&&t,e(0))}).call(this,e(2)(t))},function(t,o,e){(function(t){var n;!function(t,r,i){function a(t,o){return o.x=t.x,o.y=t.y,o.z=t.z,o.w=t.w,o.v=t.v,o.d=t.d,o}function u(t,o){var e=new function(t){var o=this,e="";o.next=function(){var t=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^t^t<<1)|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,t===(0|t)?o.x=t:e+=t;for(var n=0;n<e.length+64;n++)o.x^=0|e.charCodeAt(n),n==e.length&&(o.d=o.x<<10^o.x>>>4),o.next()}(t),n=o&&o.state,r=function(){return(e.next()>>>0)/4294967296};return r.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=e.next,r.quick=r,n&&("object"==typeof n&&a(n,e),r.state=function(){return a(e,{})}),r}r&&r.exports?r.exports=u:e(0)&&e(1)?void 0===(n=function(){return u}.call(o,e,o,r))||(r.exports=n):this.xorwow=u}(0,"object"==typeof t&&t,e(0))}).call(this,e(2)(t))},function(t,o,e){(function(t){var n;!function(t,r,i){function a(t,o){return o.x=t.x,o.y=t.y,o.z=t.z,o.w=t.w,o}function u(t,o){var e=new function(t){var o=this,e="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var t=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^t^t>>>8},t===(0|t)?o.x=t:e+=t;for(var n=0;n<e.length+64;n++)o.x^=0|e.charCodeAt(n),o.next()}(t),n=o&&o.state,r=function(){return(e.next()>>>0)/4294967296};return r.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=e.next,r.quick=r,n&&("object"==typeof n&&a(n,e),r.state=function(){return a(e,{})}),r}r&&r.exports?r.exports=u:e(0)&&e(1)?void 0===(n=function(){return u}.call(o,e,o,r))||(r.exports=n):this.xor128=u}(0,"object"==typeof t&&t,e(0))}).call(this,e(2)(t))},function(t,o,e){(function(t){var n;!function(t,r,i){function a(t,o){return o.c=t.c,o.s0=t.s0,o.s1=t.s1,o.s2=t.s2,o}function u(t,o){var e=new function(t){var o=this,e=function(){var t=4022871197;return function(o){o=o.toString();for(var e=0;e<o.length;e++){var n=.02519603282416938*(t+=o.charCodeAt(e));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)}}();o.next=function(){var t=2091639*o.s0+2.3283064365386963e-10*o.c;return o.s0=o.s1,o.s1=o.s2,o.s2=t-(o.c=0|t)},o.c=1,o.s0=e(" "),o.s1=e(" "),o.s2=e(" "),o.s0-=e(t),o.s0<0&&(o.s0+=1),o.s1-=e(t),o.s1<0&&(o.s1+=1),o.s2-=e(t),o.s2<0&&(o.s2+=1),e=null}(t),n=o&&o.state,r=e.next;return r.int32=function(){return 4294967296*e.next()|0},r.double=function(){return r()+1.1102230246251565e-16*(2097152*r()|0)},r.quick=r,n&&("object"==typeof n&&a(n,e),r.state=function(){return a(e,{})}),r}r&&r.exports?r.exports=u:e(0)&&e(1)?void 0===(n=function(){return u}.call(o,e,o,r))||(r.exports=n):this.alea=u}(0,"object"==typeof t&&t,e(0))}).call(this,e(2)(t))},function(t,o,e){var n=e(13),r=e(12),i=e(11),a=e(10),u=e(9),h=e(8),s=e(7);s.alea=n,s.xor128=r,s.xorwow=i,s.xorshift7=a,s.xor4096=u,s.tychei=h,t.exports=s},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t,o){for(var e=0;e<o.length;e++){var n=o[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(o,e,n){return e&&t(o.prototype,e),n&&t(o,n),o}}(),r=function(t){return t&&t.__esModule?t:{default:t}}(e(14));var i=function(){function t(o){!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,t),this.rng=(0,r.default)(o)}return n(t,[{key:"randomInteger",value:function(t,o){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e.onlyOdd,r=void 0!==n&&n,i=e.onlyEven,a=void 0!==i&&i;return r?this.randomOddInteger(t,o):a?this.randomEvenInteger(t,o):Math.floor(this.rng()*(o-t+1)+t)}},{key:"randomEvenInteger",value:function(t,o){t%2!=0&&t<o&&t++,o%2!=0&&o>t&&o--;var e=(o-t)/2;return 2*Math.floor(this.rng()*(e+1))+t}},{key:"randomOddInteger",value:function(t,o){t%2==0&&t++,o%2==0&&o--;var e=(o-t)/2;return 2*Math.floor(this.rng()*(e+1))+t}},{key:"randomPick",value:function(t){return t[this.randomInteger(0,t.length-1)]}}]),t}();o.default=i},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t,o){for(var e=0;e<o.length;e++){var n=o[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(o,e,n){return e&&t(o.prototype,e),n&&t(o,n),o}}(),r=h(e(15)),i=h(e(5)),a=h(e(3)),u=e(4);function h(t){return t&&t.__esModule?t:{default:t}}var s={width:50,height:50,randomSeed:void 0,chanceToLinkRooms:20,doorPadding:1,doorSize:1,rooms:{width:{min:5,max:15,onlyOdd:!1,onlyEven:!1},height:{min:5,max:15,onlyOdd:!1,onlyEven:!1},maxArea:150,maxRooms:50}},f=function(){function t(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,t);var e=o.rooms||{};e.width=Object.assign({},s.rooms.width,e.width),e.height=Object.assign({},s.rooms.height,e.height),e.maxArea=e.maxArea||s.rooms.maxArea,e.maxRooms=e.maxRooms||s.rooms.maxRooms,e.width.min<3&&(e.width.min=3),e.height.min<3&&(e.height.min=3),e.width.max<e.width.min&&(e.width.max=e.width.min),e.height.max<e.height.min&&(e.height.max=e.height.min);var n=e.width.min*e.height.min;e.maxArea<n&&(e.maxArea=n),this.doorPadding=o.doorPadding||s.doorPadding,this.doorSize=o.doorSize||s.doorSize,this.width=o.width||s.width,this.height=o.height||s.height,this.chanceToLinkRooms=o.chanceToLinkRooms||s.chanceToLinkRooms,this.roomConfig=e,this.rooms=[],this.r=new r.default(o.randomSeed),this.roomGrid=[],this.generate(),this.tiles=this.getTiles()}return n(t,[{key:"drawToConsole",value:function(t){(0,u.debugMap)(this,t)}},{key:"drawToHtml",value:function(t){return(0,u.debugHtmlMap)(this,t)}},{key:"generate",value:function(){var t=this;this.rooms=[],this.roomGrid=[];for(var o=0;o<this.height;o++){this.roomGrid.push([]);for(var e=0;e<this.width;e++)this.roomGrid[o].push([])}var n=this.createRandomRoom();n.setPosition(Math.floor(this.width/2)-Math.floor(n.width/2),Math.floor(this.height/2)-Math.floor(n.height/2)),this.addRoom(n);for(var r=5*this.roomConfig.maxRooms;this.rooms.length<this.roomConfig.maxRooms&&r>0;)this.generateRoom(),r-=1;for(var i=0;i<this.rooms.length;i++)for(var a=this.getPotentiallyTouchingRooms(this.rooms[i]),u=0;u<a.length;u++){if(!this.rooms[i].isConnectedTo(a[u]))if(Math.random()<this.chanceToLinkRooms/100)this.findNewDoorLocation(this.rooms[i],a[u]).forEach(function(o){return t.addDoor(o)})}}},{key:"getRoomAt",value:function(t,o){return t<0||o<0||t>=this.width||o>=this.height?null:this.roomGrid[o][t][0]}},{key:"getMappedTiles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=Object.assign({},{empty:0,wall:1,floor:2,door:3},t),this.tiles.map(function(o){return o.map(function(o){return o===a.default.EMPTY?t.empty:o===a.default.WALL?t.wall:o===a.default.FLOOR?t.floor:o===a.default.DOOR?t.door:void 0})})}},{key:"addRoom",value:function(t){if(!this.canFitRoom(t))return!1;this.rooms.push(t);for(var o=t.top;o<=t.bottom;o++)for(var e=t.left;e<=t.right;e++)this.roomGrid[o][e].push(t);return!0}},{key:"canFitRoom",value:function(t){if(t.x<0||t.x+t.width>this.width-1)return!1;if(t.y<0||t.y+t.height>this.height-1)return!1;for(var o=0;o<this.rooms.length;o++)if(t.overlaps(this.rooms[o]))return!1;return!0}},{key:"createRandomRoom",value:function(){var t=0,o=0,e=0,n=this.roomConfig;do{e=(t=this.r.randomInteger(n.width.min,n.width.max,{onlyEven:n.width.onlyEven,onlyOdd:n.width.onlyOdd}))*(o=this.r.randomInteger(n.height.min,n.height.max,{onlyEven:n.height.onlyEven,onlyOdd:n.height.onlyOdd}))}while(e>n.maxArea);return new i.default(t,o)}},{key:"generateRoom",value:function(){for(var t=this,o=this.createRandomRoom(),e=150;e>0;){var n=this.findRoomAttachment(o);if(o.setPosition(n.x,n.y),this.addRoom(o)){this.findNewDoorLocation(o,n.target).forEach(function(o){return t.addDoor(o)});break}e-=1}}},{key:"getTiles",value:function(){for(var t=Array(this.height),o=0;o<this.height;o++){t[o]=Array(this.width);for(var e=0;e<this.width;e++)t[o][e]=a.default.EMPTY}for(var n=0;n<this.rooms.length;n++)for(var r=this.rooms[n],i=0;i<r.height;i++)for(var u=0;u<r.width;u++)t[i+r.y][u+r.x]=r.tiles[i][u];return t}},{key:"getPotentiallyTouchingRooms",value:function(t){for(var o=[],e=function(e,n,r){for(var i=r[n][e],a=0;a<i.length;a++)if(i[a]!=t&&o.indexOf(i[a])<0){var u=e-i[a].x,h=n-i[a].y;(u>0&&u<i[a].width-1||h>0&&h<i[a].height-1)&&o.push(i[a])}},n=t.x+1;n<t.x+t.width-1;n++)e(n,t.y,this.roomGrid),e(n,t.y+t.height,this.roomGrid);for(var r=t.y+1;r<t.y+t.height-1;r++)e(t.x,r,this.roomGrid),e(t.x+t.width,r,this.roomGrid);return o}},{key:"findNewDoorLocation",value:function(t,o){var e={x:-1,y:-1,linksTo:o.id},n={x:-1,y:-1,linksTo:t.id},r=t.y===o.y-t.height,i=t.x==o.x+o.width,a=t.y==o.y+o.height,u=t.x==o.x-t.width;r?(e.x=n.x=this.r.randomInteger(Math.floor(Math.max(o.left,t.left)+this.doorPadding),Math.floor(Math.min(o.right,t.right)-this.doorPadding)),e.y=t.y+t.height-1,n.y=o.y):u?(e.x=t.x+t.width-1,n.x=o.x,e.y=n.y=this.r.randomInteger(Math.floor(Math.max(o.top,t.top)+this.doorPadding),Math.floor(Math.min(o.bottom,t.bottom)-this.doorPadding))):i?(e.x=t.x,n.x=o.x+o.width-1,e.y=n.y=this.r.randomInteger(Math.floor(Math.max(o.top,t.top)+this.doorPadding),Math.floor(Math.min(o.bottom,t.bottom)-this.doorPadding))):a&&(e.x=n.x=this.r.randomInteger(Math.floor(Math.max(o.left,t.left)+this.doorPadding),Math.floor(Math.min(o.right,t.right)-this.doorPadding)),e.y=t.y,n.y=o.y+o.height-1),t.doors.push(e),o.doors.push(n);for(var h=[],s=function(i){var u={x:-1,y:-1,linksTo:o.id},s={x:-1,y:-1,linksTo:t.id},f=Math.round(i/2),l=function(t){return function(t){return t%2}(i)?t-f:t+f};r||a?(u.y=e.y,s.y=n.y,u.x=l(e.x),s.x=l(n.x)):(u.x=e.x,s.x=n.x,u.y=l(e.y),s.y=l(n.y)),h.push(u,s),t.doors.push(u),o.doors.push(s)},f=1;f<this.doorSize;f++)s(f);return[e,n].concat(h)}},{key:"findRoomAttachment",value:function(t){var o=this.r.randomPick(this.rooms),e=0,n=0,r=2*this.doorPadding;switch(this.r.randomInteger(0,3)){case 0:e=this.r.randomInteger(o.left-(t.width-1)+r,o.right-r),n=o.top-t.height;break;case 1:e=o.left-t.width,n=this.r.randomInteger(o.top-(t.height-1)+r,o.bottom-r);break;case 2:e=o.right+1,n=this.r.randomInteger(o.top-(t.height-1)+r,o.bottom-r);break;case 3:e=this.r.randomInteger(o.left-(t.width-1)+r,o.right-r),n=o.bottom+1}return{x:e,y:n,target:o}}},{key:"addDoor",value:function(t){for(var o=this.roomGrid[t.y][t.x],e=0;e<o.length;e++){var n=o[e],r=t.x-n.x,i=t.y-n.y;n.tiles[i][r]=a.default.DOOR}}}]),t}();o.default=f},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(e(16));o.default=n.default}]).default});
//# sourceMappingURL=dungeon.min.js.map